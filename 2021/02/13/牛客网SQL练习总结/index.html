<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="牛客网SQL练习总结"><meta name="keywords" content="SQL,MySQL"><meta name="author" content="惊羽"><meta name="copyright" content="惊羽"><title>牛客网SQL练习总结 | 惊羽的博客</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://v1.hitokoto.cn/?encode=js&amp;charset=utf-8&amp;select=.footer_custom_text" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  hexoVersion: '5.4.0'
} </script><meta name="generator" content="Hexo 5.4.0"></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%A5%E5%85%85%E7%9F%A5%E8%AF%86"><span class="toc-number">1.</span> <span class="toc-text">补充知识</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A5%E5%85%85%E7%9F%A5%E8%AF%86%E6%95%B4%E7%90%86"><span class="toc-number">1.1.</span> <span class="toc-text">补充知识整理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E7%A9%BA%E6%A0%A1%E9%AA%8C%E6%96%B9%E6%B3%95"><span class="toc-number">1.2.</span> <span class="toc-text">非空校验方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%92%8C%E5%88%A0%E9%99%A4%E7%B4%A2%E5%BC%95"><span class="toc-number">1.3.</span> <span class="toc-text">创建和删除索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">1.4.</span> <span class="toc-text">触发器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0"><span class="toc-number">1.5.</span> <span class="toc-text">窗口函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E5%AE%83%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-number">1.6.</span> <span class="toc-text">其它常用函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B1%82%E6%8E%92%E5%90%8D"><span class="toc-number">2.</span> <span class="toc-text">求排名</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%82%E6%8E%92%E5%90%8D%E7%AC%ACN%E4%B8%AA%E7%9A%84"><span class="toc-number">2.1.</span> <span class="toc-text">求排名第N个的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%82%E6%9F%90%E4%B8%AA%E5%88%86%E7%BB%84%E9%87%8C%E9%9D%A2%E6%8E%92%E5%90%8D%E7%AC%ACN%E4%B8%AA"><span class="toc-number">2.2.</span> <span class="toc-text">求某个分组里面排名第N个</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E7%9B%B8%E5%85%B3"><span class="toc-number">3.</span> <span class="toc-text">用户登陆相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E8%BF%91%E7%99%BB%E9%99%86%E6%97%A5%E6%9C%9F"><span class="toc-number">3.1.</span> <span class="toc-text">最近登陆日期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%A1%E6%97%A5%E7%95%99%E5%AD%98%E7%8E%87"><span class="toc-number">3.2.</span> <span class="toc-text">次日留存率</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AF%8F%E6%97%A5%E6%96%B0%E5%A2%9E%E7%94%A8%E6%88%B7%E6%95%B0"><span class="toc-number">3.3.</span> <span class="toc-text">每日新增用户数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E7%94%A8%E6%88%B7%E6%AC%A1%E6%97%A5%E7%95%99%E5%AD%98%E7%8E%87"><span class="toc-number">3.4.</span> <span class="toc-text">新用户次日留存率</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E5%B9%B6%E7%BB%9F%E8%AE%A1%E6%A0%B8%E5%BF%83%E8%A1%8C%E4%B8%BA%E7%BB%9F%E8%AE%A1"><span class="toc-number">3.5.</span> <span class="toc-text">用户登陆并统计核心行为统计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%82%E8%BF%9E%E7%BB%AD%E7%99%BB%E9%99%86N%E5%A4%A9%E7%9A%84%E7%94%A8%E6%88%B7"><span class="toc-number">3.6.</span> <span class="toc-text">求连续登陆N天的用户</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E4%BD%8D%E6%95%B0%E7%9B%B8%E5%85%B3"><span class="toc-number">4.</span> <span class="toc-text">中位数相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%82%E4%B8%AD%E4%BD%8D%E6%95%B0"><span class="toc-number">4.1.</span> <span class="toc-text">求中位数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%82%E4%B8%AD%E4%BD%8D%E6%95%B0%E4%BB%A5%E4%B8%8A%E7%9A%84%E6%83%85%E5%86%B5"><span class="toc-number">4.2.</span> <span class="toc-text">求中位数以上的情况</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.jpg"></div><div class="author-info__name text-center">惊羽</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">21</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">15</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">8</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/img/post/nowcoder.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">惊羽的博客</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a><a class="site-page" href="/about">About</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">牛客网SQL练习总结</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-02-13</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E9%9D%A2%E8%AF%95%E5%87%86%E5%A4%87/">面试准备</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h2 id="补充知识"><a href="#补充知识" class="headerlink" title="补充知识"></a>补充知识</h2><h3 id="补充知识整理"><a href="#补充知识整理" class="headerlink" title="补充知识整理"></a>补充知识整理</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span>一张表可以多次被引用使用</span><br><span class="line"><span class="number">2.</span>筛选条件包含某个值, 这个值可以通过子查询求出, 再通过 <span class="keyword">where</span> 条件判断</span><br><span class="line"><span class="number">3.</span>子查询没有符合要求的条件会直接返回 <span class="keyword">null</span></span><br><span class="line"><span class="number">4.</span><span class="keyword">insert</span> ignore <span class="keyword">into</span> 相当于 replace</span><br><span class="line"><span class="number">5.</span>创建视图格式:  <span class="keyword">create</span> <span class="keyword">view</span> actor_name_view <span class="keyword">as</span> <span class="operator">+</span> 字段列表(查询结果等)</span><br><span class="line"><span class="number">6.</span>查询强制走索引: <span class="keyword">from</span> 表名 <span class="operator">+</span> force index(索引名)</span><br><span class="line"><span class="number">7.</span>创建表字段后<span class="operator">+</span> <span class="keyword">default</span> <span class="string">&#x27;默认值&#x27;</span>, 即赋予默认值</span><br><span class="line"><span class="number">8.</span>如果需要对数据进行更新操作, 一定是通过update 或者 replace 进行</span><br><span class="line"><span class="number">9.</span>需要排除最大值最小值再进行计算的题目,可以通过子查询排除, 或者通过 first_value last_value 开窗函数进行</span><br><span class="line"><span class="number">10.</span>exsits 用来判断是否存在某种条件的记录，存在就返回 <span class="literal">true</span> ,不存在则返回 <span class="literal">false</span></span><br><span class="line"><span class="number">11.</span>第 <span class="number">1</span> 的隐含条件是 该字段数值大于 它的数量为 <span class="number">0</span> , 大于等于它的数量为 <span class="number">1</span> , 以此类推</span><br><span class="line"><span class="number">12.</span>聚合字段的部分值，可以让其它值为<span class="number">0</span>，为<span class="keyword">null</span>，聚合的时候不影响结果</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="非空校验方法"><a href="#非空校验方法" class="headerlink" title="非空校验方法"></a>非空校验方法</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--如果x为null，就返回y，否则返回x</span></span><br><span class="line">nvl(x,y)</span><br><span class="line"><span class="comment">--返回集合中第一个不为null的值，如果全部为null就返回null</span></span><br><span class="line">colease(x,y,e,d,f)</span><br><span class="line"><span class="comment">--如果x为null，就返回y，否则返回x</span></span><br><span class="line">ifnull(x,y)</span><br></pre></td></tr></table></figure>

<h3 id="创建和删除索引"><a href="#创建和删除索引" class="headerlink" title="创建和删除索引"></a>创建和删除索引</h3><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/e1824daa0c49404aa602cf0cb34bdd75">SQL37 对first_name创建唯一索引uniq_idx_firstname</a></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- MySQL中4种方式给字段添加索引</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建主键索引,索引值必须是唯一的，且不能为NULL。</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tbl_name <span class="keyword">ADD</span> <span class="keyword">PRIMARY</span> KEY (col_list);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建唯一索引,值唯一</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tbl_name <span class="keyword">ADD</span> <span class="keyword">UNIQUE</span> index_name (col_list);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建普通索引,索引值可以重复出现</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tbl_name <span class="keyword">ADD</span> INDEX index_name (col_list);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建全文索引, 指定索引</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tbl_name <span class="keyword">ADD</span> FULLTEXT index_name (col_list);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除索引</span></span><br><span class="line"><span class="keyword">DROP</span> INDEX index_name <span class="keyword">ON</span> tbl_name;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tbl_name <span class="keyword">DROP</span> INDEX index_name；</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tbl_name <span class="keyword">DROP</span> <span class="keyword">PRIMARY</span> KEY;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">在MySQL中，创建触发器语法如下：</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trigger_name</span><br><span class="line">trigger_time trigger_event <span class="keyword">ON</span> tbl_name</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">trigger_stmt</span><br><span class="line">其中：</span><br><span class="line"></span><br><span class="line">trigger_name：标识触发器名称，用户自行指定；</span><br><span class="line">trigger_time：标识触发时机，取值为 BEFORE 或 AFTER；</span><br><span class="line">trigger_event：标识触发事件，取值为 <span class="keyword">INSERT</span>、UPDATE 或 <span class="keyword">DELETE</span>；</span><br><span class="line">tbl_name：标识建立触发器的表名，即在哪张表上建立触发器；</span><br><span class="line">trigger_stmt：触发器程序体，可以是一句<span class="keyword">SQL</span>语句，或者用 <span class="keyword">BEGIN</span> 和 <span class="keyword">END</span> 包含的多条语句，每条语句结束要分号结尾。</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.notion.so/7e920bb2e1e74c4e83750f5c16033e2e">SQL41 构造一个触发器audit_log</a></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> audit_log</span><br><span class="line">after <span class="keyword">insert</span> <span class="keyword">on</span> employees_test</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> audit <span class="keyword">values</span>(new.id,new.name);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<h3 id="窗口函数"><a href="#窗口函数" class="headerlink" title="窗口函数"></a>窗口函数</h3><ul>
<li>窗口函数完整模式</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 指定字段求和并排序，窗口范围所有行</span></span><br><span class="line"><span class="built_in">sum</span>(x) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> a <span class="keyword">order</span> <span class="keyword">by</span> b  <span class="keyword">rows</span> <span class="keyword">between</span> unbounded preceding  <span class="keyword">and</span> unbounded following )</span><br><span class="line"><span class="comment">-- 指定字段求和并排序，窗口范围是从改值前面的行到当前行</span></span><br><span class="line"><span class="built_in">sum</span>(x) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> a <span class="keyword">order</span> <span class="keyword">by</span> b  <span class="keyword">rows</span> <span class="keyword">between</span> unbounded preceding  <span class="keyword">and</span> <span class="keyword">current</span> <span class="type">row</span> )</span><br><span class="line"><span class="comment">-- 指定字段求和并做排序，将所有行当前字段数据中，当前行值+2 和 -2范围之内的所有值求和 </span></span><br><span class="line"><span class="built_in">sum</span>(x) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> a <span class="keyword">range</span> <span class="keyword">between</span> <span class="number">2</span> preceding  <span class="keyword">and</span> <span class="number">2</span> followling )</span><br></pre></td></tr></table></figure>

<ul>
<li>常用窗口函数</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 排名窗口函数</span></span><br><span class="line"><span class="built_in">row_number</span>()</span><br><span class="line"><span class="built_in">rank</span>()</span><br><span class="line"><span class="built_in">dense_rank</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 聚合窗口函数</span></span><br><span class="line">sum 求和</span><br><span class="line">count 总数</span><br><span class="line">max 最大值</span><br><span class="line">min 最小值</span><br><span class="line">avg 平均值</span><br><span class="line"></span><br><span class="line"><span class="comment">--其它窗口函数</span></span><br><span class="line">lag 上一行的值</span><br><span class="line">lead 下一行的值</span><br><span class="line">first_value 该字段第一行的值</span><br><span class="line">last_value 该字段最后一行的值</span><br></pre></td></tr></table></figure>

<h3 id="其它常用函数"><a href="#其它常用函数" class="headerlink" title="其它常用函数"></a>其它常用函数</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">concat(字符<span class="number">1</span>, 连接符,字符<span class="number">2</span>) 指定连接符连接字符 <span class="number">1</span> 和字符 <span class="number">2</span></span><br><span class="line"></span><br><span class="line">group_concat（X，Y）</span><br><span class="line">X是要连接的字段，</span><br><span class="line">Y是连接时用的符号，可省略，默认为逗号。</span><br><span class="line">此函数必须与<span class="keyword">group</span> <span class="keyword">by</span> 配合使用。</span><br><span class="line"></span><br><span class="line">统计字符串长度：</span><br><span class="line"><span class="keyword">char_length</span>(<span class="string">&#x27;string&#x27;</span>) <span class="operator">/</span> <span class="keyword">char_length</span>(column_name)</span><br><span class="line"><span class="number">1</span>、返回值为字符串string或者对应字段长度，长度的单位为字符，一个多字节字符（例如，汉字）算作一个单字符；</span><br><span class="line"><span class="number">2</span>、不管汉字还是数字或者是字母都算是一个字符；</span><br><span class="line"><span class="number">3</span>、任何编码下，多字节字符都算是一个字符；</span><br><span class="line">参考资料来源：https:<span class="operator">/</span><span class="operator">/</span>blog.csdn.net<span class="operator">/</span>iris_xuting<span class="operator">/</span>article<span class="operator">/</span>details<span class="operator">/</span><span class="number">53763894</span></span><br><span class="line"></span><br><span class="line">length(<span class="string">&#x27;string&#x27;</span>)<span class="operator">/</span>length(column_name)</span><br><span class="line"><span class="number">1</span>、utf8字符集编码下,一个汉字是算三个字符,一个数字或字母算一个字符。</span><br><span class="line"><span class="number">2</span>、其他编码下,一个汉字算两个字符, 一个数字或字母算一个字符。</span><br><span class="line"></span><br><span class="line">字符串替换：replace(s,s1,s2)，将字符串 s2 替代字符串 s 中的字符串 s1</span><br><span class="line">MySQL常用函数：https:<span class="operator">/</span><span class="operator">/</span>www.runoob.com<span class="operator">/</span>mysql<span class="operator">/</span>mysql<span class="operator">-</span>functions.html</span><br><span class="line"></span><br><span class="line">截取字符串函数 substr(X,Y,Z) 或 substr(X,Y) </span><br><span class="line">X是要截取的字符串 </span><br><span class="line">Y是字符串的起始位置</span><br><span class="line">Z是要截取字符串的长度</span><br><span class="line"></span><br><span class="line"><span class="keyword">left</span> 和 <span class="keyword">right</span> 函数切割，后面 <span class="keyword">left</span>(a,<span class="number">7</span>) a是要切割的字符串，<span class="number">7</span>是切割位数</span><br><span class="line"></span><br><span class="line">date_sub(<span class="type">date</span>,expr) <span class="type">date</span><span class="operator">/</span>datetime 减去expr 值后返回对应 <span class="type">date</span><span class="operator">/</span>datetime                   </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="求排名"><a href="#求排名" class="headerlink" title="求排名"></a>求排名</h2><h3 id="求排名第N个的"><a href="#求排名第N个的" class="headerlink" title="求排名第N个的"></a>求排名第N个的</h3><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/ec1ca44c62c14ceb990c3c40def1ec6c">SQL2 查找入职员工时间排名倒数第三的员工所有信息</a></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 方法1:先求出排名求第N个, 再倒排</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> (<span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> hire_date <span class="keyword">desc</span></span><br><span class="line">limit <span class="number">0</span>,<span class="number">3</span>) e</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> e.hire_date</span><br><span class="line">limit <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方法2:子查询,排名字段比自己高大于N的即可, 缺点是如果数据少于排名就不能求出</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> employees e1</span><br><span class="line"><span class="keyword">where</span> <span class="number">2</span><span class="operator">=</span>(<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> employees e2 <span class="keyword">where</span> e1.hire_date <span class="operator">&lt;</span> e2.hire_date);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方法3:子查询, 比排名N+1中最高的就是第N个</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方法4:开窗函数，不计算重复就用row_number ，统计重复就dense_rank，子查询 &lt;=N 即可。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="求某个分组里面排名第N个"><a href="#求某个分组里面排名第N个" class="headerlink" title="求某个分组里面排名第N个"></a>求某个分组里面排名第N个</h3><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/4a052e3e1df5435880d4353eb18a91c6">SQL12 获取每个部门中当前员工薪水最高的相关信息</a></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 1.窗口函数求出每个成员在分组里面的排名</span></span><br><span class="line"><span class="comment">-- 2.子查询让排名等于N</span></span><br><span class="line"><span class="comment">-- 3.可以做个非空校验, 如果没有符合的的rank, 就返回指定值.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">dept_no,emp_no,salary <span class="keyword">as</span> maxSalary</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line"><span class="keyword">select</span> d.dept_no,d.emp_no,s.salary,<span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> d.dept_no <span class="keyword">order</span> <span class="keyword">by</span> s.salary <span class="keyword">desc</span>)  <span class="keyword">as</span> r1</span><br><span class="line"><span class="keyword">from</span> dept_emp d, salaries s</span><br><span class="line"><span class="keyword">where</span> d.emp_no <span class="operator">=</span>s.emp_no) ss</span><br><span class="line"><span class="keyword">where</span> r1<span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> dept_no;</span><br></pre></td></tr></table></figure>

<h2 id="用户登陆相关"><a href="#用户登陆相关" class="headerlink" title="用户登陆相关"></a>用户登陆相关</h2><h3 id="最近登陆日期"><a href="#最近登陆日期" class="headerlink" title="最近登陆日期"></a>最近登陆日期</h3><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/7cc3c814329546e89e71bb45c805c9ad">SQL67 牛客每个人最近的登录日期(二）</a></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--基本思路就是求出最近登陆的日期和 user_id 作为字典表，里面对应的user_id 就是最近登陆的用户，查询即可。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> u.name,c.name,l.date</span><br><span class="line"><span class="keyword">from</span> login l, <span class="keyword">user</span> u , client c</span><br><span class="line"><span class="keyword">where</span> l.user_id<span class="operator">=</span>u.id <span class="keyword">and</span> l.client_id<span class="operator">=</span>c.id</span><br><span class="line"><span class="keyword">and</span> (l.user_id,l.date) <span class="keyword">in</span>(<span class="keyword">select</span> user_id,<span class="built_in">max</span>(<span class="type">date</span>) <span class="keyword">from</span> login <span class="keyword">group</span> <span class="keyword">by</span> user_id)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> u.name;</span><br></pre></td></tr></table></figure>

<h3 id="次日留存率"><a href="#次日留存率" class="headerlink" title="次日留存率"></a>次日留存率</h3><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/16d41af206cd4066a06a3a0aa585ad3d">SQL68 牛客每个人最近的登录日期(三)</a></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 1.筛选出初次登陆的新用户</span></span><br><span class="line"><span class="keyword">select</span> user_id,<span class="built_in">min</span>(<span class="type">date</span>)</span><br><span class="line"><span class="keyword">from</span> login </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> user_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">--2.新用户登陆后, 第二天登陆的情况</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> round(<span class="built_in">count</span>(<span class="keyword">distinct</span> user_id) <span class="operator">/</span> (<span class="keyword">select</span> <span class="built_in">count</span>(<span class="keyword">distinct</span> user_id) <span class="keyword">from</span> login) ,<span class="number">3</span>) <span class="keyword">as</span> p</span><br><span class="line"><span class="keyword">from</span> login</span><br><span class="line"><span class="keyword">where</span> (user_id,<span class="type">date</span>) <span class="keyword">in</span> (<span class="keyword">select</span> user_id,date_add(<span class="built_in">min</span>(<span class="type">date</span>),<span class="type">INTERVAL</span> <span class="number">1</span> <span class="keyword">day</span>) <span class="keyword">from</span> login <span class="keyword">group</span> <span class="keyword">by</span> user_id)</span><br></pre></td></tr></table></figure>

<h3 id="每日新增用户数"><a href="#每日新增用户数" class="headerlink" title="每日新增用户数"></a>每日新增用户数</h3><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/e524dc7450234395aa21c75303a42b0a">SQL69 牛客每个人最近的登录日期(四)</a></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--1.求出新用户登陆日期</span></span><br><span class="line"><span class="keyword">select</span> user_id,<span class="built_in">min</span>(<span class="type">date</span>) <span class="keyword">as</span> <span class="type">date</span> </span><br><span class="line"><span class="keyword">from</span> login </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> user_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">--2.通过case when 判断, 如果当天登陆用户中和新用户登陆表相同则记为1,否则是0.</span></span><br><span class="line"><span class="keyword">select</span> tmp.date,<span class="built_in">sum</span>(tmp.t) <span class="keyword">as</span> <span class="keyword">new</span></span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">(<span class="keyword">select</span> <span class="type">date</span>,</span><br><span class="line"><span class="keyword">case</span> </span><br><span class="line"><span class="keyword">when</span> (user_id,<span class="type">date</span>) <span class="keyword">in</span> </span><br><span class="line">(<span class="keyword">select</span> user_id,<span class="built_in">min</span>(<span class="type">date</span>) <span class="keyword">as</span> <span class="type">date</span> </span><br><span class="line"><span class="keyword">from</span> login </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> user_id) </span><br><span class="line"><span class="keyword">then</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">else</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">end</span> <span class="keyword">as</span> t</span><br><span class="line"><span class="keyword">from</span> login) tmp</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="type">date</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="type">date</span>;</span><br></pre></td></tr></table></figure>

<h3 id="新用户次日留存率"><a href="#新用户次日留存率" class="headerlink" title="新用户次日留存率"></a>新用户次日留存率</h3><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/ea0c56cd700344b590182aad03cc61b8">SQL70 牛客每个人最近的登录日期(五)</a></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--分子:当前日期+ 1day 中是前一天新用户的用户</span></span><br><span class="line"><span class="comment">--分母 当前日期中是新用户, 即当前日期是该用户所有登陆日期中最小的</span></span><br><span class="line"><span class="comment">--当前日期-1day =date   等于 当前日期= date + 1day</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="type">date</span>,</span><br><span class="line">ifnull(round (</span><br><span class="line"><span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> (user_id,<span class="type">date</span>) <span class="keyword">in</span> (<span class="keyword">select</span> user_id, <span class="built_in">min</span>(<span class="type">date</span>) <span class="keyword">from</span> login <span class="keyword">group</span> <span class="keyword">by</span> user_id) </span><br><span class="line"> <span class="keyword">and</span> (user_id,<span class="type">date</span>) <span class="keyword">in</span> (<span class="keyword">select</span> user_id, date_add(<span class="type">date</span>,<span class="type">interval</span> <span class="number">-1</span> <span class="keyword">day</span>) <span class="keyword">from</span> login <span class="keyword">group</span> <span class="keyword">by</span> user_id) </span><br><span class="line"><span class="keyword">then</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">else</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">end</span>)</span><br><span class="line">  <span class="operator">/</span></span><br><span class="line"><span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> (user_id,<span class="type">date</span>) <span class="keyword">in</span> (<span class="keyword">select</span> user_id, <span class="built_in">min</span>(<span class="type">date</span>) <span class="keyword">from</span> login <span class="keyword">group</span> <span class="keyword">by</span> user_id)</span><br><span class="line"><span class="keyword">then</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">else</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">end</span>),</span><br><span class="line">  <span class="number">3</span>),<span class="number">0</span>)<span class="keyword">as</span> p</span><br><span class="line"><span class="keyword">from</span> login</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="type">date</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="type">date</span>;</span><br></pre></td></tr></table></figure>

<h3 id="用户登陆并统计核心行为统计"><a href="#用户登陆并统计核心行为统计" class="headerlink" title="用户登陆并统计核心行为统计"></a>用户登陆并统计核心行为统计</h3><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/572a027e52804c058e1f8b0c5e8a65b4">SQL71 牛客每个人最近的登录日期(六)</a></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 1.先求出每个用户登陆时候的刷题信息和姓名</span></span><br><span class="line"><span class="comment">-- 2.根据日期排序, 再根据姓名排序</span></span><br><span class="line"><span class="comment">-- 3.题目是求到某一天累计刷题多少, 我们可以通过子查询筛选符合的</span></span><br><span class="line"><span class="keyword">select</span> p1.user_id,p1.date,<span class="built_in">sum</span>(p1.number) <span class="keyword">as</span> number</span><br><span class="line"><span class="keyword">from</span> passing_number p1,passing_number p2</span><br><span class="line"><span class="keyword">where</span>  p1.user_id<span class="operator">=</span>p2.user_id <span class="keyword">and</span> p1.date<span class="operator">&gt;=</span>p2.date</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> p1.user_id,p1.date;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 最终SQL</span></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">u.name,p.date,p.number</span><br><span class="line"><span class="keyword">from</span> login l,(<span class="keyword">select</span> p1.user_id,p1.date,<span class="built_in">sum</span>(p2.number) <span class="keyword">as</span> number</span><br><span class="line"><span class="keyword">from</span> passing_number p1 </span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> passing_number p2</span><br><span class="line"><span class="keyword">on</span>  p1.user_id<span class="operator">=</span>p2.user_id <span class="keyword">and</span> p1.date<span class="operator">&gt;=</span>p2.date</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> p1.user_id,p1.date) p ,<span class="keyword">user</span> u </span><br><span class="line"><span class="keyword">where</span> l.user_id<span class="operator">=</span>p.user_id <span class="keyword">and</span> l.date<span class="operator">=</span>p.date <span class="keyword">and</span> l.user_id<span class="operator">=</span>u.id</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> p.date,u.name;</span><br></pre></td></tr></table></figure>

<h3 id="求连续登陆N天的用户"><a href="#求连续登陆N天的用户" class="headerlink" title="求连续登陆N天的用户"></a>求连续登陆N天的用户</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--求连续三天登录的人数的方法</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace temporary <span class="keyword">view</span> mytab <span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;zs&#x27;</span> name, <span class="string">&#x27;2021-08-01&#x27;</span> logintime <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;zs&#x27;</span> name, <span class="string">&#x27;2021-08-02&#x27;</span> logintime <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;zs&#x27;</span> name, <span class="string">&#x27;2021-08-03&#x27;</span> logintime <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;zs&#x27;</span> name, <span class="string">&#x27;2021-08-04&#x27;</span> logintime;</span><br><span class="line"></span><br><span class="line"><span class="comment">--思路一，将having count(1)&gt;=n，就是求连续n天登录的人数</span></span><br><span class="line"><span class="comment">--连续三天登陆等于登陆日期-登陆的次数排序=第一天登陆</span></span><br><span class="line"><span class="keyword">with</span> t1 <span class="keyword">as</span> ( <span class="keyword">select</span> <span class="keyword">distinct</span> name,logintime <span class="keyword">from</span> mytab),</span><br><span class="line">     t2 <span class="keyword">as</span> ( <span class="keyword">select</span> <span class="operator">*</span>,</span><br><span class="line">                    date_sub(logintime,<span class="built_in">row_number</span>() <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> name <span class="keyword">order</span> <span class="keyword">by</span> logintime)) <span class="keyword">as</span> temp_date</span><br><span class="line">             <span class="keyword">from</span> t1 )</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="keyword">distinct</span> name) cnt</span><br><span class="line"><span class="keyword">from</span> t2</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> name, temp_date</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(<span class="number">1</span>)<span class="operator">&gt;=</span><span class="number">3</span></span><br><span class="line">;</span><br><span class="line"><span class="comment">--思路二，将下面的date_add(logintime,n-1)，lead(logintime,n-1) ，就是求连续n天登录的人数</span></span><br><span class="line"><span class="keyword">with</span> t1 <span class="keyword">as</span> ( <span class="keyword">select</span> <span class="keyword">distinct</span> name,logintime <span class="keyword">from</span> mytab),</span><br><span class="line">     t2 <span class="keyword">as</span> ( <span class="keyword">select</span> <span class="operator">*</span>,</span><br><span class="line">                    date_add(logintime,<span class="number">2</span>) <span class="keyword">as</span> expectdate,</span><br><span class="line">                    <span class="built_in">lead</span>(logintime,<span class="number">2</span>) <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> name <span class="keyword">order</span> <span class="keyword">by</span> logintime) realdate</span><br><span class="line">             <span class="keyword">from</span> t1 )</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="keyword">distinct</span> name) cnt  <span class="keyword">from</span> t2 <span class="keyword">where</span> expectdate<span class="operator">=</span>realdate</span><br><span class="line">;</span><br></pre></td></tr></table></figure>

<h2 id="中位数相关"><a href="#中位数相关" class="headerlink" title="中位数相关"></a>中位数相关</h2><h3 id="求中位数"><a href="#求中位数" class="headerlink" title="求中位数"></a>求中位数</h3><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/502fb6e2b1ad4e56aa2e0dd90c6edf3c">考试分数（四）</a></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--需求</span></span><br><span class="line"><span class="comment">--请你写一个sql语句查询各个岗位分数升序排列之后的中位数位置的范围，并且按job升序排序</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--补充知识</span></span><br><span class="line"><span class="comment">--中位数的特征：</span></span><br><span class="line"><span class="comment">--当个数为偶数时，中位数的起始位置等于个数/2，结束位置等于个数/2+1</span></span><br><span class="line"><span class="comment">--当个数为奇数时，中位数的起始位置等于向上取整（个数/2），结束位置等于向上取整（个数/2）</span></span><br><span class="line"><span class="comment">--用除以2的余数是否为0来判断奇偶，%2=0</span></span><br><span class="line"><span class="comment">--记得取整数，本题用ceiling函数向上取整（返回不小于该数的最小整数值）或round(数，0)四舍五入取整都可以</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--我的写法</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">job,</span><br><span class="line"><span class="built_in">ceil</span>(<span class="built_in">count</span>(id)<span class="operator">/</span><span class="number">2</span>) <span class="keyword">as</span> <span class="keyword">start</span>,</span><br><span class="line"><span class="keyword">case</span> </span><br><span class="line"><span class="keyword">when</span> <span class="built_in">count</span>(id)<span class="operator">%</span><span class="number">2</span><span class="operator">=</span><span class="number">0</span></span><br><span class="line"><span class="keyword">then</span> <span class="built_in">ceil</span>(<span class="built_in">count</span>(id)<span class="operator">/</span><span class="number">2</span><span class="operator">+</span><span class="number">1</span>)</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">ceil</span>(<span class="built_in">count</span>(id)<span class="operator">/</span><span class="number">2</span>)</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">as</span> <span class="keyword">end</span></span><br><span class="line"><span class="keyword">from</span> grade</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> job</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> job;</span><br><span class="line"></span><br><span class="line"># 大神简化版 ,后面的<span class="operator">+</span><span class="number">1</span>再除以<span class="number">2</span>, </span><br><span class="line"><span class="keyword">select</span> job, round(<span class="built_in">count</span>(id)<span class="operator">/</span><span class="number">2</span>), round((<span class="built_in">count</span>(id)<span class="operator">+</span><span class="number">1</span>)<span class="operator">/</span><span class="number">2</span>)</span><br><span class="line"><span class="keyword">from</span> grade </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> job</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> job;</span><br></pre></td></tr></table></figure>

<h3 id="求中位数以上的情况"><a href="#求中位数以上的情况" class="headerlink" title="求中位数以上的情况"></a>求中位数以上的情况</h3><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/b626ff9e2ad04789954c2132c74c0512">考试分数（五）</a></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--需求</span></span><br><span class="line"><span class="comment">--请你写一个sql语句查询各个岗位分数的中位数位置上的所有grade信息，并且按id升序排序</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--1.先求出中位数范围</span></span><br><span class="line"><span class="comment">--2.再通过开窗函数求出每个同学分数的自然排名</span></span><br><span class="line"><span class="comment">--3.按照id排序</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">tmp.id,tmp.job,tmp.score,tmp.t_rank</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line"><span class="keyword">SELECT</span> id,job,score,</span><br><span class="line">  <span class="built_in">row_number</span>() <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> job <span class="keyword">order</span> <span class="keyword">by</span> score <span class="keyword">desc</span>) t_rank,</span><br><span class="line">  <span class="built_in">count</span>(score) <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> job) <span class="keyword">as</span> cnt</span><br><span class="line">  <span class="keyword">from</span> grade) <span class="keyword">as</span> tmp</span><br><span class="line">  <span class="keyword">where</span> tmp.t_rank<span class="operator">=</span><span class="built_in">floor</span>((tmp.cnt<span class="operator">+</span><span class="number">1</span>)<span class="operator">/</span><span class="number">2</span>) <span class="keyword">or</span> tmp.t_rank<span class="operator">=</span><span class="built_in">floor</span>((tmp.cnt<span class="operator">+</span><span class="number">2</span>)<span class="operator">/</span><span class="number">2</span>)</span><br><span class="line">  <span class="keyword">order</span> <span class="keyword">by</span> tmp.id;</span><br></pre></td></tr></table></figure></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">惊羽</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://jface001.github.io/2021/02/13/牛客网SQL练习总结/">https://jface001.github.io/2021/02/13/牛客网SQL练习总结/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SAw 4.0</a> 许可协议。转载请注明来自 <a href="https://jface001.github.io">惊羽的博客</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/SQL/">SQL</a><a class="post-meta__tags" href="/tags/MySQL/">MySQL</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2021/03/05/Hive%E6%95%B0%E4%BB%93%E7%BC%93%E6%85%A2%E6%B8%90%E5%8F%98%E7%BB%B4%E4%B9%8B%E6%8B%89%E9%93%BE%E8%A1%A8/"><i class="fa fa-chevron-left">  </i><span>Hive数仓缓慢渐变维之拉链表</span></a></div><div class="next-post pull-right"><a href="/2021/01/07/Redis%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/"><span>Redis常见面试题</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: 'fd4471bb76ba37363dfe',
  clientSecret: '945ad45c695de45f4f9ee79068049e1f6ccf5f04',
  repo: 'GitalkRepo',
  owner: 'Jface001',
  admin: 'Jface001',
  id: md5(decodeURI(location.pathname)),
  language: 'zh-CN'
})
gitalk.render('gitalk-container')</script></div></div><footer class="footer-bg" style="background-image: url(/img/post/nowcoder.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2020 - 2022 By 惊羽</div><div class="framework-info"><span>驱动 - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">hitokoto</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>